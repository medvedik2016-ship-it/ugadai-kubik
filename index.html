<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–≥–∞–¥–∞–π –ö—É–±–∏–∫</title>
    <style>
        :root {
            --color-bg-primary: #0f172a;
            --color-bg-surface: #1e293b;
            --color-text-primary: #f1f5f9;
            --color-text-secondary: #cbd5e1;
            --color-primary: #38bdf8;
            --color-primary-hover: #0ea5e9;
            --color-success: #10b981;
            --color-error: #ef4444;
            --font-family-base: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family-base);
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--color-text-primary);
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: var(--color-bg-surface);
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--color-text-secondary);
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--color-primary);
        }

        .game-area {
            background: var(--color-bg-surface);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        .table {
            width: 100%;
            height: 250px;
            background: linear-gradient(180deg, #92400e 0%, #78350f 100%);
            border-radius: 15px;
            position: relative;
            margin-bottom: 30px;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
        }

        .cups-container {
            display: flex;
            justify-content: center;
            gap: 60px;
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
        }

        .cup {
            width: 100px;
            height: 100px;
            background: linear-gradient(145deg, #2d3748 0%, #1a202c 100%);
            border-radius: 8px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.6), 
                        inset 0 2px 5px rgba(255,255,255,0.1),
                        inset 0 -2px 5px rgba(0,0,0,0.3);
            transform-style: preserve-3d;
        }

        .cup:hover:not(.revealed) {
            transform: translateY(-20px) rotateX(-5deg);
            box-shadow: 0 20px 40px rgba(0,0,0,0.7), 
                        inset 0 2px 5px rgba(255,255,255,0.1),
                        inset 0 -2px 5px rgba(0,0,0,0.3);
        }

        .cup::before {
            display: none;
        }

        .cup.revealed {
            transform: translateY(-30px) rotateX(-15deg);
            box-shadow: 0 25px 50px rgba(0,0,0,0.8),
                        inset 0 2px 5px rgba(255,255,255,0.1),
                        inset 0 -2px 5px rgba(0,0,0,0.3);
        }

        .cup.correct {
            background: linear-gradient(145deg, #ffffff 0%, #e5e5e5 100%);
            animation: glowWhite 0.6s ease-in-out;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.8),
                        0 0 60px rgba(255, 255, 255, 0.5),
                        0 10px 30px rgba(0,0,0,0.6),
                        inset 0 2px 10px rgba(255,255,255,0.5);
        }

        @keyframes glowWhite {
            0%, 100% { 
                box-shadow: 0 0 30px rgba(255, 255, 255, 0.8),
                           0 0 60px rgba(255, 255, 255, 0.5),
                           0 10px 30px rgba(0,0,0,0.6);
            }
            50% { 
                box-shadow: 0 0 50px rgba(255, 255, 255, 1),
                           0 0 100px rgba(255, 255, 255, 0.8),
                           0 10px 30px rgba(0,0,0,0.6);
            }
        }

        .cup.wrong {
            animation: shatter 0.8s ease-out forwards;
        }

        @keyframes shatter {
            0% {
                opacity: 1;
                transform: translateY(-30px) rotateX(-15deg) scale(1);
            }
            20% {
                transform: translateY(-30px) rotateX(-15deg) scale(1.05);
            }
            50% {
                opacity: 0.7;
                transform: translateY(-10px) rotateX(20deg) rotateZ(15deg) scale(0.9);
            }
            100% {
                opacity: 0;
                transform: translateY(50px) rotateX(90deg) rotateZ(45deg) scale(0.3);
            }
        }

        .fragments {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .fragment {
            position: absolute;
            width: 20px;
            height: 20px;
            background: linear-gradient(145deg, #2d3748 0%, #1a202c 100%);
            opacity: 0;
        }

        .cup.wrong .fragment {
            animation: explode 0.8s ease-out forwards;
        }

        @keyframes explode {
            0% {
                opacity: 1;
                transform: translate(0, 0) rotate(0deg) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) rotate(var(--rotate)) scale(0.2);
            }
        }

        .cup.revealed {
            cursor: default;
        }

        .controls {
            text-align: center;
        }

        .settings {
            margin-bottom: 20px;
        }

        .settings label {
            display: block;
            margin-bottom: 10px;
            color: var(--color-text-secondary);
        }

        .settings input,
        .settings select {
            width: 150px;
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #475569;
            background: var(--color-bg-primary);
            color: var(--color-text-primary);
            text-align: center;
            font-size: 1rem;
        }

        .settings select {
            cursor: pointer;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: var(--color-primary);
            color: var(--color-bg-primary);
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(56, 189, 248, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .message {
            text-align: center;
            font-size: 1.25rem;
            font-weight: bold;
            margin-top: 20px;
            min-height: 30px;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.success {
            color: var(--color-success);
        }

        .message.error {
            color: var(--color-error);
        }

        .result-summary {
            background: var(--color-bg-surface);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            animation: scaleIn 0.3s;
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .result-summary h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--color-primary);
        }

        .result-summary p {
            font-size: 1.25rem;
            margin-bottom: 15px;
            color: var(--color-text-secondary);
        }

        .result-summary .final-score {
            font-size: 3rem;
            font-weight: bold;
            color: var(--color-success);
            margin: 20px 0;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ –£–≥–∞–¥–∞–π –ö—É–±–∏–∫</h1>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-label">–†–∞—É–Ω–¥</div>
                <div class="stat-value" id="currentRound">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">–£–≥–∞–¥–∞–Ω–æ</div>
                <div class="stat-value" id="wins">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">–ü—Ä–æ–º–∞—Ö–æ–≤</div>
                <div class="stat-value" id="losses">0</div>
            </div>
        </div>

        <div class="game-area" id="gameArea">
            <div class="table">
                <div class="cups-container" id="cupsContainer"></div>
            </div>

            <div class="controls">
                <div class="settings" id="settings">
                    <label>
                        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—É–±–∏–∫–æ–≤:
                        <select id="cupsInput" class="form-control">
                            <option value="2">2 –∫—É–±–∏–∫–∞</option>
                            <option value="3">3 –∫—É–±–∏–∫–∞</option>
                            <option value="4">4 –∫—É–±–∏–∫–∞</option>
                        </select>
                    </label>
                    <label style="margin-top: 15px;">
                        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤:
                        <input type="number" id="roundsInput" min="1" max="50" value="10">
                    </label>
                </div>
                <button class="btn btn-primary" id="startBtn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                <div class="message" id="message"></div>
            </div>
        </div>

        <div class="result-summary hidden" id="resultSummary">
            <h2>üéâ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</h2>
            <div class="final-score" id="finalScore">0/0</div>
            <p>–í—ã —É–≥–∞–¥–∞–ª–∏ <strong id="finalWins">0</strong> —Ä–∞–∑ –∏–∑ <strong id="totalRounds">0</strong></p>
            <p>–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ø–∞–¥–∞–Ω–∏–π: <strong id="percentage">0</strong>%</p>
            <button class="btn btn-primary" id="playAgainBtn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>
    </div>

    <script>
        const cupsContainer = document.querySelector('.cups-container');
        const startBtn = document.getElementById('startBtn');
        const playAgainBtn = document.getElementById('playAgainBtn');
        const cupsInput = document.getElementById('cupsInput');
        const roundsInput = document.getElementById('roundsInput');
        const settings = document.getElementById('settings');
        const message = document.getElementById('message');
        const currentRoundEl = document.getElementById('currentRound');
        const winsEl = document.getElementById('wins');
        const lossesEl = document.getElementById('losses');
        const gameArea = document.getElementById('gameArea');
        const resultSummary = document.getElementById('resultSummary');
        const finalScore = document.getElementById('finalScore');
        const finalWins = document.getElementById('finalWins');
        const totalRoundsEl = document.getElementById('totalRounds');
        const percentage = document.getElementById('percentage');

        let totalRounds = 10;
        let totalCups = 2;
        let currentRound = 0;
        let wins = 0;
        let losses = 0;
        let ballPosition = -1;
        let gameActive = false;
        let cups = [];

        function createCups(count) {
            cupsContainer.innerHTML = '';
            cups = [];
            
            const gaps = {
                2: '60px',
                3: '40px',
                4: '30px'
            };
            
            cupsContainer.style.gap = gaps[count] || '40px';
            
            for (let i = 0; i < count; i++) {
                const cup = document.createElement('div');
                cup.className = 'cup';
                cup.dataset.cup = i;
                
                const fragments = document.createElement('div');
                fragments.className = 'fragments';
                
                for (let j = 0; j < 8; j++) {
                    const fragment = document.createElement('div');
                    fragment.className = 'fragment';
                    const angle = (j / 8) * Math.PI * 2;
                    const distance = 80 + Math.random() * 40;
                    fragment.style.setProperty('--tx', `${Math.cos(angle) * distance}px`);
                    fragment.style.setProperty('--ty', `${Math.sin(angle) * distance}px`);
                    fragment.style.setProperty('--rotate', `${Math.random() * 360}deg`);
                    fragment.style.left = '40%';
                    fragment.style.top = '40%';
                    fragments.appendChild(fragment);
                }
                
                cup.appendChild(fragments);
                cupsContainer.appendChild(cup);
                cups.push(cup);
                
                cup.addEventListener('click', handleCupClick);
            }
        }

        function resetGame() {
            currentRound = 0;
            wins = 0;
            losses = 0;
            gameActive = false;
            updateStats();
            message.textContent = '';
            message.className = 'message';
            
            totalCups = parseInt(cupsInput.value) || 2;
            createCups(totalCups);
            
            startBtn.disabled = false;
            settings.style.display = 'block';
            gameArea.classList.remove('hidden');
            resultSummary.classList.add('hidden');
        }

        function startNewRound() {
            currentRound++;
            updateStats();
            ballPosition = Math.floor(Math.random() * totalCups);
            
            createCups(totalCups);

            message.textContent = `–†–∞—É–Ω–¥ ${currentRound}/${totalRounds}: –ù–∞–π–¥–∏—Ç–µ –∑–∞–≥–∞–¥–∞–Ω–Ω—ã–π –∫—É–±–∏–∫!`;
            message.className = 'message';
            gameActive = true;
        }

        function handleCupClick(event) {
            if (!gameActive) return;

            const cup = event.currentTarget;
            const cupIndex = parseInt(cup.dataset.cup);
            
            gameActive = false;

            if (cupIndex === ballPosition) {
                cup.classList.add('revealed', 'correct');
                wins++;
                message.textContent = 'üéâ –í–µ—Ä–Ω–æ! –í—ã —É–≥–∞–¥–∞–ª–∏!';
                message.className = 'message success';
            } else {
                cup.classList.add('revealed', 'wrong');
                cups[ballPosition].classList.add('revealed', 'correct');
                losses++;
                message.textContent = '‚ùå –ù–µ —É–≥–∞–¥–∞–ª–∏! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑';
                message.className = 'message error';
            }

            updateStats();

            if (currentRound < totalRounds) {
                setTimeout(() => {
                    startNewRound();
                }, 2500);
            } else {
                setTimeout(() => {
                    showResults();
                }, 2500);
            }
        }

        function updateStats() {
            currentRoundEl.textContent = currentRound;
            winsEl.textContent = wins;
            lossesEl.textContent = losses;
        }

        function showResults() {
            gameArea.classList.add('hidden');
            resultSummary.classList.remove('hidden');
            
            const percent = totalRounds > 0 ? Math.round((wins / totalRounds) * 100) : 0;
            
            finalScore.textContent = `${wins}/${totalRounds}`;
            finalWins.textContent = wins;
            totalRoundsEl.textContent = totalRounds;
            percentage.textContent = percent;
        }

        startBtn.addEventListener('click', () => {
            totalRounds = parseInt(roundsInput.value) || 10;
            if (totalRounds < 1) totalRounds = 1;
            if (totalRounds > 50) totalRounds = 50;
            
            totalCups = parseInt(cupsInput.value) || 2;
            createCups(totalCups);
            
            startBtn.disabled = true;
            settings.style.display = 'none';
            startNewRound();
        });

        playAgainBtn.addEventListener('click', () => {
            resetGame();
        });

        resetGame();
    </script>
</body>
</html>
